# 小红书笔记生成器 - 项目需求文档

## 项目概述
开发一个基于Web的工作流处理器，用户可以文字/文件，通过调用扣子工作流API后输出完整的coze工作流反馈。项目采用科技感风格设计，具备完整的图文展示、复制、下载等功能。


## 技术要求
- **平台**: 纯静态网页，可直接在浏览器运行
- **兼容性**: 移动端优先，响应式设计
- **技术栈**: HTML5 + CSS3 + JavaScript (原生)
- **API集成**: 扣子工作流API (非流式响应)
- **外部依赖**: JSZip库用于批量下载功能

## 功能需求

### 1. 用户输入界面
- **页面标题**: "🤖 小红书笔记 AI智能体"
- **副标题**: "输入主题，AI为你生成爆款小红书图文笔记"
- **主题输入框**: 
  - 多行文本输入(textarea)
  - 占位符文本："请输入你想要生成的小红书笔记主题，例如：旅游攻略、美食推荐、护肤心得等..."
  - 4行高度，支持垂直调整
  - 必填字段验证
- **图片生成选项**: 
  - 复选框，带图标🖼️
  - 标签："生成配图"
  - 帮助文本："勾选此选项将为你的笔记生成相关图片"
- **提交按钮**: 
  - 文本："✨ 生成笔记"
  - 加载时显示旋转动画
  - 禁用状态处理

### 2. API集成规格
- **接口地址**: `https://api.coze.cn/v1/workflow/run`
- **请求方法**: POST
- **认证方式**: Bearer Token
- **Token**: `pat_oNDcg7WtXF32zNmtvWqSDQNw7XrRWNKLurIyhFFm2b9z5FWseYYwSzvtu6Js1KUk`
- **工作流ID**: `7548423845913853979`
- **请求参数**:
  ```json
  {
    "workflow_id": "7548423845913853979",
    "parameters": {
      "title": "用户输入的主题",
      "pictures": true/false
    }
  }
  ```
- **响应处理**:
  - 检查HTTP状态码
  - 检查业务状态码(code字段)
  - 解析data字段中的内容和图片数据

### 3. 加载状态界面
- **加载动画**: 三个点的弹跳动画
- **加载文本**: "AI正在为你生成爆款笔记..."
- **状态管理**: 隐藏输入界面，显示加载界面

### 4. 结果展示界面

#### 4.1 笔记内容区域
- **区域标题**: "📝 笔记内容"
- **复制按钮**: "📋 复制" - 复制原始文本内容
- **内容显示**: 
  - 格式化显示(保留换行、特殊符号)
  - 原始文本隐藏存储(用于复制)
- **操作按钮**:
  - "🔄 重新生成" - 使用相同参数重新调用API
  - "✏️ 重新创作" - 返回输入界面

#### 4.2 图片展示区域(如果有图片)
- **区域标题**: "📷 配图"
- **下载按钮**: "📥 下载" - 批量下载所有图片和文本
- **图片网格**:
  - 响应式网格布局
  - 1张图片：单列居中，最大宽度300px
  - 2张图片：双列布局
  - 3张及以上：三列布局
  - 图片比例：3:4(宽3高4)
  - 圆角12px，悬停放大效果
  - 自动高度，支持多排图片完整显示
- **图片处理**:
  - 加载失败显示错误提示
  - 支持多种图片格式
  - object-fit: cover确保填充

### 5. 错误处理界面
- **错误图标**: ❌
- **错误标题**: "生成失败"
- **错误信息**: 显示具体错误原因
- **重试按钮**: "🔄 重试" - 重新执行上次操作

### 6. 高级功能

#### 6.1 复制功能
- 使用Clipboard API
- 复制成功显示Toast提示
- 降级处理(document.execCommand)

#### 6.2 下载功能
- **文本下载**: 生成.txt文件
- **图片下载**: 批量下载为ZIP文件
- **文件命名**: 
  - 文本：xiaohongshu_note_[时间戳].txt
  - 图片：image_1.jpg, image_2.jpg等
  - ZIP：xiaohongshu_images_[时间戳].zip

#### 6.3 Toast提示系统
- 成功/错误状态提示
- 3秒自动消失
- 渐入渐出动画效果

## UI/UX设计要求

### 1. 整体风格
- **设计语言**: 现代简约，小红书风格
- **主色调**: #FF2442 (小红书红)
- **辅助色**: 渐变背景(#ff6b6b, #feca57, #48dbfb, #ff9ff3, #54a0ff)
- **背景**: 动态渐变动画(15秒循环)
- **卡片设计**: 白色背景，圆角24px，阴影效果

### 2. 动画效果
- **背景渐变**: 135度方向，400%大小，位置动画
- **机器人图标**: 脉冲动画，阴影效果
- **按钮交互**: 悬停上移2px，点击反馈
- **加载动画**: 三点弹跳，旋转spinner
- **图片悬停**: 轻微放大效果

### 3. 响应式设计
- **容器宽度**: 最大600px，居中布局
- **移动端适配**: 
  - 减小内边距和字体
  - 触摸友好的按钮尺寸
  - 图片网格自适应
- **字体系统**: 系统字体栈，中英文优化

### 4. 交互细节
- **表单验证**: 实时验证，错误提示
- **状态反馈**: 按钮禁用、加载状态
- **焦点管理**: 清晰的焦点指示
- **无障碍**: 语义化HTML，键盘导航

## 技术实现细节

### 1. 文件结构
```
xhs/
├── index.html          # 主页面
├── styles.css          # 样式文件(876行)
├── script.js           # 主要逻辑(765行)
└── 项目需求文档.md      # 项目文档
```

### 2. HTML结构要点
- **语言设置**: lang="zh-CN"
- **视口配置**: 移动端优化
- **外部依赖**: JSZip CDN引入
- **DOM结构**: 
  - container > header + input-section + loading-section + result-section + error-section
  - 结果区域包含xiaohongshu-note卡片
  - 图片区域包含images-header和images-grid

### 3. CSS架构
- **重置样式**: 全局box-sizing, margin, padding重置
- **CSS变量**: 主题色彩管理
- **动画库**: 自定义keyframes动画
- **网格系统**: CSS Grid布局
- **响应式**: 媒体查询适配

### 4. JavaScript架构
- **模块化设计**: 功能函数分离
- **状态管理**: currentState变量控制界面状态
- **事件系统**: 统一的事件绑定管理
- **错误处理**: 完整的try-catch和用户友好提示
- **工具函数**: debounce, throttle等性能优化

### 5. 核心功能模块

#### 5.1 应用初始化
```javascript
// DOM元素引用管理
const elements = {
    form, topicInput, generateImagesCheckbox,
    submitBtn, btnText, loadingSpinner,
    inputSection, loadingSection, resultSection, errorSection,
    noteText, rawNoteText, noteImages, imagesContainer,
    errorMessage, regenerateBtn, newNoteBtn, retryBtn,
    copyTextBtn, downloadAllBtn
};

// 状态变量
let currentState = 'input';
let lastFormData = null;
let rawNoteContent = '';
let imageUrls = [];
```

#### 5.2 API数据解析
- 支持多种数据格式：img_list, images, image字段
- URL清理和验证
- 图片数量自适应网格布局

#### 5.3 图片处理
- 动态创建img元素
- 加载状态和错误处理
- 3:4比例显示
- 网格布局(single/double/triple类)

#### 5.4 下载系统
- JSZip集成
- 异步图片获取
- 文件类型检测
- 进度反馈

## 开发指南

### 1. 开发顺序
1. **HTML结构搭建** - 完整的DOM结构和语义化标签
2. **CSS样式实现** - 渐变背景、卡片设计、响应式布局
3. **JavaScript基础** - DOM引用、事件绑定、状态管理
4. **API集成** - fetch请求、数据解析、错误处理
5. **结果展示** - 内容格式化、图片网格、交互功能
6. **高级功能** - 复制、下载、Toast提示
7. **优化调试** - 性能优化、兼容性测试

### 2. 关键实现点
- **API配置**: 确保token和workflowId正确
- **图片容器**: 使用imageGallery作为ID
- **图片网格**: 不设置max-height限制，确保多排图片完整显示
- **状态切换**: showSection函数管理界面显示
- **数据解析**: parseAPIResult处理多种数据格式
- **错误边界**: 完整的错误捕获和用户提示

### 3. 测试要点
- API调用成功/失败场景
- 图片加载成功/失败处理
- 复制功能在不同浏览器的兼容性
- 下载功能的文件完整性
- 移动端触摸交互
- 网络异常情况处理

## 部署说明
- **运行方式**: 直接在浏览器打开index.html
- **本地服务器**: 推荐使用python -m http.server
- **CORS处理**: API支持跨域请求
- **浏览器兼容**: 现代浏览器(ES6+支持)

## 注意事项
- Token和工作流ID需要根据实际情况配置
- 图片URL需要支持跨域访问
- 下载功能需要用户手动触发(浏览器安全限制)
- 移动端测试时注意触摸事件和视口适配
- 确保所有异步操作都有适当的错误处理
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>噼里啪啦小助手 - 工作流处理器</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- 头部标题 -->
        <header class="header">
            <h1 class="title">“噼里啪啦”小助手</h1>
            <p class="subtitle">帮你减少频繁“噼里啪啦”打键盘的好助手！</p>
            <!-- 导航按钮 -->
            <div class="nav-buttons" id="nav-buttons" style="display: none;">
                <button class="btn btn-secondary" onclick="showMainMenu()">
                    <span class="btn-icon">🏠</span>
                    返回主页
                </button>
            </div>
        </header>

        <!-- 主导航界面 -->
        <div class="main-menu" id="main-menu">
            <div class="menu-grid">
                <div class="menu-card" onclick="openWorkflowPage('pricing')">
                    <div class="menu-icon">💰</div>
                    <h3 class="menu-title">报价小顾问</h3>
                    <p class="menu-description">对于首次报价又不知道如何提供命中高的报价，可以输入物料名、厂家来获取报价建议哦</p>
                    <div class="menu-arrow">→</div>
                </div>
                

                
                <div class="menu-card" onclick="openWorkflowPage('material')">
                    <div class="menu-icon">📦</div>
                    <h3 class="menu-title">物料查询</h3>
                    <p class="menu-description">可以通过输入物料名、厂家来获取物料的详细信息：ID、名称、规格、考核价、特定价、效期等信息</p>
                    <div class="menu-arrow">→</div>
                </div>
                
                <div class="menu-card" onclick="openWorkflowPage('excel')">
                    <div class="menu-icon">📊</div>
                    <h3 class="menu-title">Excel报价（500条行信息内）匹配出报价</h3>
                    <p class="menu-description">上传Excel文件进行报价（4%和特定价做比对）</p>
                    <div class="menu-arrow">→</div>
                </div>
            </div>
        </div>

        <!-- 报价查询工作流独立界面 -->
        <div class="pricing-workflow-page" id="pricing-workflow-page" style="display: none;">
            <div class="workflow-container">
                <div class="single-workflow">
                    <div class="workflow-header">
                        <h1>报价小顾问！</h1>
                    </div>
                    <div class="workflow-content">
                        <div class="workflow-description">
                            <p>对于首次报价又不知道如何提供命中高的报价，可以输入物料名、厂家来获取报价建议哦（以下预输入：感冒灵颗粒，可直接运行）</p>
                        </div>
                        <div class="input-section">
                            <textarea placeholder="请输入文字内容..." class="text-input" id="pricing-input"></textarea>
                        </div>
                        <div class="action-buttons">
                            <button class="btn btn-primary" onclick="processWorkflow('pricing')">
                                <span class="btn-icon">⚡</span>
                                处理工作流
                            </button>
                        </div>
                    </div>
                    <div class="result-area" id="pricing-result" style="display: none;">
                        <div class="result-header">
                            <h3>处理结果</h3>
                            <button class="btn btn-view" onclick="viewDetailedResult('pricing')" title="查看详细结果">
                                <span class="btn-icon">👁️</span>
                                详细查看
                            </button>
                        </div>
                        <div class="result-content"></div>
                        <div class="result-actions">
                            <button class="btn btn-secondary" onclick="copyResult('pricing')">复制</button>
                            <button class="btn btn-secondary" onclick="downloadResult('pricing')">下载</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 简单物料查询工作流独立界面 -->
        <div class="material-workflow-page" id="material-workflow-page" style="display: none;">
            <div class="workflow-container">
                <div class="single-workflow">
                    <div class="workflow-header">
                        <h1>物料查询</h1>
                    </div>
                    <div class="workflow-content">
                        <div class="workflow-description">
                            <p>可以通过输入物料名、厂家来获取物料的详细信息：ID、名称、规格、考核价、特定价、效期等信息（以下预输入：感冒灵颗粒等信息，可直接运行）</p>
                        </div>
                        <div class="input-section">
                            <textarea placeholder="请输入物料查询内容..." class="text-input" id="material-input"></textarea>
                        </div>
                        <div class="action-buttons">
                            <button class="btn btn-primary" onclick="processWorkflow('material')">
                                <span class="btn-icon">⚡</span>
                                处理工作流
                            </button>
                        </div>
                    </div>
                    <div class="result-area" id="material-result" style="display: none;">
                        <div class="result-header">
                            <h3>处理结果</h3>
                            <button class="btn btn-view" onclick="viewDetailedResult('material')" title="查看详细结果">
                                <span class="btn-icon">👁️</span>
                                详细查看
                            </button>
                        </div>
                        <div class="result-content"></div>
                        <div class="result-actions">
                            <button class="btn btn-secondary" onclick="copyResult('material')">复制</button>
                            <button class="btn btn-secondary" onclick="downloadResult('material')">下载</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 报价Excel匹配工作流独立界面 -->
        <div class="excel-workflow-page" id="excel-workflow-page" style="display: none;">
            <div class="workflow-container">
                <div class="single-workflow">
                    <div class="workflow-header">
                        <h1>Excel报价（500条行信息内）匹配出报价</h1>
                    </div>
                    <div class="workflow-content">
                        <div class="workflow-description">
                            <p>报价逻辑是：4%点为基准，如果上次销售时间在3个月内，则用上次销售价格作为报价，特定价如果大于4%点，则用特定价作为报价</p>
                        </div>
                        <div class="file-upload-section">
                            <div class="upload-zone" id="excel-upload-zone" onclick="document.getElementById('excel-file-input').click()">
                                <div class="upload-icon">📊</div>
                                <p class="upload-text">点击选择Excel文件或拖拽文件到此处</p>
                                <p class="upload-hint">支持 .xlsx, .xls 格式文件</p>
                                <input type="file" id="excel-file-input" accept=".xlsx,.xls" style="display: none;" onchange="handleExcelFileSelect(event)">
                            </div>
                            <div class="file-info" id="excel-file-info" style="display: none;">
                                <div class="file-details">
                                    <span class="file-name"></span>
                                    <span class="file-size"></span>
                                </div>
                                <button class="btn btn-secondary btn-small" onclick="clearExcelFile()">
                                    <span class="btn-icon">🗑️</span>
                                    清除
                                </button>
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button class="btn btn-primary" id="excel-process-btn" onclick="processExcelWorkflow()" disabled>
                                <span class="btn-icon">⚡</span>
                                处理Excel文件
                            </button>
                        </div>
                    </div>
                    <div class="result-area" id="excel-result" style="display: none;">
                        <div class="result-header">
                            <h3>处理结果</h3>
                            <button class="btn btn-view" onclick="viewDetailedResult('excel')" title="查看详细结果">
                                <span class="btn-icon">👁️</span>
                                详细查看
                            </button>
                        </div>
                        <div class="result-content"></div>
                        <div class="result-actions">
                            <button class="btn btn-secondary" onclick="copyResult('excel')">复制</button>
                            <button class="btn btn-secondary" onclick="downloadResult('excel')">下载</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 全局操作区域 -->
        <div class="global-actions" id="global-actions" style="display: none;">
            <button class="btn btn-primary" onclick="downloadAllResults()">
                <span class="btn-icon">📦</span>
                批量下载所有结果
            </button>
        </div>

        <!-- 页脚 -->
        <footer class="footer">
            <p>&copy; 2025 噼里啪啦小助手 - 智能工作流处理器</p>
        </footer>
    </div>

    <!-- 加载动画 -->
    <div class="loading-overlay" id="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>正在处理中...</p>
        </div>
    </div>

    <!-- 详细结果查看弹窗 -->
    <div id="result-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">详细处理结果</h2>
                <button class="modal-close" onclick="closeResultModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modal-result-content" class="formatted-result"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="copyModalResult()">复制全部</button>
                <button class="btn btn-secondary" onclick="downloadModalResult()">下载</button>
                <button class="btn btn-primary" onclick="closeResultModal()">关闭</button>
            </div>
        </div>
    </div>
    <div id="modal-overlay" class="modal-overlay" onclick="closeResultModal()" style="display: none;"></div>

    <script src="script.js"></script>
</body>
</html>